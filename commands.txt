# Basis commands for a new VM

sudo apt-get update

# Java
sudo apt-get install -y default-jre

# Language
sudo locale-gen en_CA.utf8
sudo locale-gen fr_CA.utf8

# xdebug missing configs for all php versions

phpVDirs=/etc/php/*

for phpVDir in $phpVDirs
do

        phpV=$(echo $phpVDir| cut -d '/' -f 4)

        sudo phpenmod -v $phpV xdebug

        # FPM
        sudo sed -i '/xdebug.remote_connect_back/ d' /etc/php/$phpV/mods-available/xdebug.ini                 #delete
        sudo sed -i '$s/$/\nxdebug.remote_host = 192.168.10.1/' /etc/php/$phpV/mods-available/xdebug.ini      #insert
        sudo sed -i '$s/$/\nxdebug.remote_autostart=1/' /etc/php/$phpV/mods-available/xdebug.ini              #insert

        sudo service php$phpV-fpm restart
done

sudo service nginx restart
